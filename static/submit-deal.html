<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Submit a Deal | Cigar Price Scout</title>
  <meta name="description" content="Found a great cigar deal? Submit it to help fellow cigar enthusiasts save money." />
  <link rel="canonical" href="https://cigarpricescout.com/submit-deal.html" />
  <link rel="icon" type="image/png" href="/static/logo.png">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: { 50: '#faf7f2', 500: '#7c5c2e', 600: '#6b4f27' },
            ink: '#111111',
            muted: '#4b5563',
          },
          fontFamily: {
            serif: ['Cormorant Garamond', 'Georgia', 'serif'],
            display: ['Cinzel', 'Georgia', 'serif'],
          },
        },
      },
    }
  </script>
  
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@500;700&family=Cormorant+Garamond:ital,wght@0,400;0,500;0,600;1,400;1,500&display=swap" rel="stylesheet" />
  
  <style>
    .conditional-fields { display: none; }
    .conditional-fields.visible { display: block; }
  </style>
</head>

<body class="bg-brand-50 font-serif text-ink text-lg leading-relaxed">
  <div class="max-w-3xl mx-auto px-5">
    
    <!-- Header -->
    <header class="flex flex-col items-center justify-center gap-2 py-7 text-center">
      <a href="/">
        <img src="/static/logo.png" alt="Cigar Price Scout Logo" class="w-24 h-20 object-contain" />
      </a>
      <div class="font-display font-bold text-3xl tracking-wide">Cigar Price Scout</div>
      <p class="italic text-muted text-xl">Community Deal Submission</p>
    </header>
    
    <main>
      <a href="/" class="inline-block text-brand-500 font-medium hover:underline mb-5">&larr; Back to Search</a>
      
      <h1 class="font-display font-bold text-3xl text-center mb-3">Submit a Deal</h1>
      <p class="text-center text-muted text-lg mb-8">Found a great cigar deal? Share it with the community!</p>
      
      <!-- Success Message -->
      <div id="successMessage" class="hidden bg-emerald-50 border border-emerald-500 text-emerald-700 p-6 rounded-xl text-center mb-6">
        <h3 class="font-display font-bold text-xl mb-2">Thank You!</h3>
        <p class="mb-3">Your deal has been submitted for review. We'll verify and add it to our site shortly.</p>
        <p><a href="/" class="text-brand-500 hover:underline">Return to Home</a> | <a href="/deals" class="text-brand-500 hover:underline">View Best Deals</a></p>
      </div>
      
      <!-- Error Message -->
      <div id="errorMessage" class="hidden bg-red-50 border border-red-500 text-red-700 p-4 rounded-lg mb-6"></div>
      
      <!-- Form -->
      <form id="dealForm" class="bg-white border border-gray-200 rounded-xl p-8 shadow-sm">
        
        <!-- Retailer Section -->
        <div class="mb-8 pb-8 border-b border-gray-200">
          <h3 class="font-display font-semibold text-lg text-brand-500 mb-4">Retailer Information</h3>
          <div class="mb-4">
            <label for="retailer" class="block font-semibold mb-2">Retailer Name <span class="text-muted font-normal text-sm">(required)</span></label>
            <input type="text" id="retailer" name="retailer" placeholder="e.g., Fox Cigar, Cigar Page, Atlantic Cigar" required
                   class="w-full p-3 border border-gray-200 rounded-xl bg-white font-serif text-lg focus:outline-none focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 transition-all">
          </div>
        </div>
        
        <!-- Deal Type Section -->
        <div class="mb-8 pb-8 border-b border-gray-200">
          <h3 class="font-display font-semibold text-lg text-brand-500 mb-4">Deal Type</h3>
          <div class="mb-4">
            <label class="block font-semibold mb-3">What kind of deal is this? <span class="text-muted font-normal text-sm">(required)</span></label>
            <div class="flex flex-wrap gap-4">
              <label class="flex items-center gap-2 cursor-pointer">
                <input type="radio" name="deal_type" value="promo_code" required class="w-4 h-4">
                <span>Promo Code</span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer">
                <input type="radio" name="deal_type" value="sale_price" class="w-4 h-4">
                <span>Sale Price (no code needed)</span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer">
                <input type="radio" name="deal_type" value="bundle" class="w-4 h-4">
                <span>Bundle Deal</span>
              </label>
            </div>
          </div>
          
          <div id="promoCodeField" class="conditional-fields bg-gray-50 p-4 rounded-lg mt-4">
            <label for="promo_code" class="block font-semibold mb-2">Promo Code</label>
            <input type="text" id="promo_code" name="promo_code" placeholder="e.g., SAVE20, HOLIDAY15"
                   class="w-full p-3 border border-gray-200 rounded-xl bg-white font-serif text-lg focus:outline-none focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 transition-all">
          </div>
        </div>
        
        <!-- Scope Section -->
        <div class="mb-8 pb-8 border-b border-gray-200">
          <h3 class="font-display font-semibold text-lg text-brand-500 mb-4">What Does This Deal Apply To?</h3>
          <div class="mb-4">
            <label class="block font-semibold mb-3">Deal Scope <span class="text-muted font-normal text-sm">(required)</span></label>
            <div class="flex flex-wrap gap-4">
              <label class="flex items-center gap-2 cursor-pointer">
                <input type="radio" name="scope" value="site" required class="w-4 h-4">
                <span>Site-wide</span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer">
                <input type="radio" name="scope" value="brand" class="w-4 h-4">
                <span>Specific Brand</span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer">
                <input type="radio" name="scope" value="line" class="w-4 h-4">
                <span>Specific Line</span>
              </label>
              <label class="flex items-center gap-2 cursor-pointer">
                <input type="radio" name="scope" value="sku" class="w-4 h-4">
                <span>Specific Product</span>
              </label>
            </div>
          </div>
          
          <div id="scopeFields" class="conditional-fields bg-gray-50 p-4 rounded-lg mt-4 space-y-4">
            <div>
              <label for="brand" class="block font-semibold mb-2">Brand</label>
              <input type="text" id="brand" name="brand" placeholder="e.g., Padron, Arturo Fuente"
                     class="w-full p-3 border border-gray-200 rounded-xl bg-white font-serif text-lg focus:outline-none focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 transition-all">
            </div>
            <div id="lineField" class="hidden">
              <label for="line" class="block font-semibold mb-2">Line</label>
              <input type="text" id="line" name="line" placeholder="e.g., 1964 Anniversary, Hemingway"
                     class="w-full p-3 border border-gray-200 rounded-xl bg-white font-serif text-lg focus:outline-none focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 transition-all">
            </div>
            <div id="skuFields" class="hidden grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="wrapper" class="block font-semibold mb-2">Wrapper <span class="text-muted font-normal text-sm">(optional)</span></label>
                <input type="text" id="wrapper" name="wrapper" placeholder="e.g., Maduro, Natural"
                       class="w-full p-3 border border-gray-200 rounded-xl bg-white font-serif text-lg focus:outline-none focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 transition-all">
              </div>
              <div>
                <label for="size" class="block font-semibold mb-2">Size <span class="text-muted font-normal text-sm">(optional)</span></label>
                <input type="text" id="size" name="size" placeholder="e.g., 6 x 52, Robusto"
                       class="w-full p-3 border border-gray-200 rounded-xl bg-white font-serif text-lg focus:outline-none focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 transition-all">
              </div>
            </div>
          </div>
        </div>
        
        <!-- Discount Section -->
        <div class="mb-8 pb-8 border-b border-gray-200">
          <h3 class="font-display font-semibold text-lg text-brand-500 mb-4">Discount Details</h3>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
            <div>
              <label for="discount_percent" class="block font-semibold mb-2">Discount Percentage</label>
              <input type="number" id="discount_percent" name="discount_percent" placeholder="e.g., 15" min="0" max="100"
                     class="w-full p-3 border border-gray-200 rounded-xl bg-white font-serif text-lg focus:outline-none focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 transition-all">
            </div>
            <div>
              <label for="discount_dollars" class="block font-semibold mb-2">OR Dollar Amount Off</label>
              <input type="number" id="discount_dollars" name="discount_dollars" placeholder="e.g., 25" min="0" step="0.01"
                     class="w-full p-3 border border-gray-200 rounded-xl bg-white font-serif text-lg focus:outline-none focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 transition-all">
            </div>
          </div>
          <div class="mb-4">
            <label for="expiration" class="block font-semibold mb-2">Expiration Date <span class="text-muted font-normal text-sm">(if known)</span></label>
            <input type="date" id="expiration" name="expiration"
                   class="w-full p-3 border border-gray-200 rounded-xl bg-white font-serif text-lg focus:outline-none focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 transition-all">
          </div>
          <div>
            <label for="deal_url" class="block font-semibold mb-2">Link to Deal <span class="text-muted font-normal text-sm">(optional but helpful)</span></label>
            <input type="url" id="deal_url" name="deal_url" placeholder="https://..."
                   class="w-full p-3 border border-gray-200 rounded-xl bg-white font-serif text-lg focus:outline-none focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 transition-all">
          </div>
        </div>
        
        <!-- Your Info Section -->
        <div class="mb-8">
          <h3 class="font-display font-semibold text-lg text-brand-500 mb-4">Your Information</h3>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
            <div>
              <label for="submitter_name" class="block font-semibold mb-2">Your Name</label>
              <input type="text" id="submitter_name" name="submitter_name" placeholder="First name or username" required
                     class="w-full p-3 border border-gray-200 rounded-xl bg-white font-serif text-lg focus:outline-none focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 transition-all">
            </div>
            <div>
              <label for="submitter_email" class="block font-semibold mb-2">Email</label>
              <input type="email" id="submitter_email" name="submitter_email" placeholder="your@email.com" required
                     class="w-full p-3 border border-gray-200 rounded-xl bg-white font-serif text-lg focus:outline-none focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 transition-all">
            </div>
          </div>
          <div>
            <label for="notes" class="block font-semibold mb-2">Additional Notes <span class="text-muted font-normal text-sm">(optional)</span></label>
            <textarea id="notes" name="notes" rows="3" placeholder="Any additional details about the deal..."
                      class="w-full p-3 border border-gray-200 rounded-xl bg-white font-serif text-lg focus:outline-none focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500 transition-all resize-none"></textarea>
          </div>
        </div>
        
        <button type="submit" id="submitBtn"
                class="w-full bg-brand-500 hover:bg-brand-600 text-white font-bold py-4 px-6 rounded-xl text-xl transition-all duration-200 shadow-md hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed">
          Submit Deal
        </button>
      </form>
    </main>
    
    <!-- Footer -->
    <footer class="mt-10 py-5 border-t border-gray-200 text-center text-muted text-sm">
      <p class="space-x-2">
        <a href="/" class="text-brand-500 hover:underline">Home</a>
        <span>|</span>
        <a href="/deals" class="text-brand-500 hover:underline">Best Deals</a>
        <span>|</span>
        <a href="/about.html" class="text-brand-500 hover:underline">About</a>
        <span>|</span>
        <a href="/contact.html" class="text-brand-500 hover:underline">Contact</a>
      </p>
      <p class="mt-2">&copy; 2025 Cigar Price Scout</p>
    </footer>
  </div>

  <script>
    // Show/hide conditional fields based on deal type
    document.querySelectorAll('input[name="deal_type"]').forEach(radio => {
      radio.addEventListener('change', function() {
        const promoField = document.getElementById('promoCodeField');
        promoField.classList.toggle('visible', this.value === 'promo_code');
      });
    });
    
    // Show/hide scope fields based on selection
    document.querySelectorAll('input[name="scope"]').forEach(radio => {
      radio.addEventListener('change', function() {
        const scopeFields = document.getElementById('scopeFields');
        const lineField = document.getElementById('lineField');
        const skuFields = document.getElementById('skuFields');
        
        if (this.value === 'site') {
          scopeFields.classList.remove('visible');
        } else {
          scopeFields.classList.add('visible');
          lineField.classList.toggle('hidden', !(this.value === 'line' || this.value === 'sku'));
          skuFields.classList.toggle('hidden', this.value !== 'sku');
        }
      });
    });
    
    // Form submission
    document.getElementById('dealForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const submitBtn = document.getElementById('submitBtn');
      const errorMsg = document.getElementById('errorMessage');
      const successMsg = document.getElementById('successMessage');
      
      submitBtn.disabled = true;
      submitBtn.textContent = 'Submitting...';
      errorMsg.classList.add('hidden');
      
      try {
        const formData = new FormData(this);
        const data = {
          retailer: formData.get('retailer'),
          deal_type: formData.get('deal_type'),
          scope: formData.get('scope'),
          brand: formData.get('brand') || null,
          line: formData.get('line') || null,
          wrapper: formData.get('wrapper') || null,
          size: formData.get('size') || null,
          promo_code: formData.get('promo_code') || null,
          discount_percent: formData.get('discount_percent') ? parseFloat(formData.get('discount_percent')) : null,
          discount_dollars: formData.get('discount_dollars') ? parseFloat(formData.get('discount_dollars')) : null,
          expiration: formData.get('expiration') || null,
          deal_url: formData.get('deal_url') || null,
          submitter_name: formData.get('submitter_name'),
          submitter_email: formData.get('submitter_email'),
          notes: formData.get('notes') || null
        };
        
        const response = await fetch('/api/submit-deal', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        
        const result = await response.json();
        
        if (result.status === 'success') {
          this.classList.add('hidden');
          successMsg.classList.remove('hidden');
          successMsg.scrollIntoView({ behavior: 'smooth' });
        } else {
          throw new Error(result.message || 'Submission failed');
        }
        
      } catch (error) {
        errorMsg.textContent = error.message || 'An error occurred. Please try again.';
        errorMsg.classList.remove('hidden');
        submitBtn.disabled = false;
        submitBtn.textContent = 'Submit Deal';
      }
    });
  </script>
</body>
</html>
